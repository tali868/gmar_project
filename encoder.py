from typing import List, Dict

import pandas as pd
from sklearn.preprocessing import OrdinalEncoder

VESSEL_ID = "vessel_id"
PREV_PORT = "prev_port"
PREV_PORT_NAME = "prev_port_name"
PORT = "curr_port"
PORT_NAME = "curr_port_name"

naive_train_set = [
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},

    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db686", PREV_PORT_NAME: "Puerto Cortes",
     PORT: "5358fc77b68ca120a07db680", PORT_NAME: "Puerto Barrios"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db680", PREV_PORT_NAME: "Puerto Barrios",
     PORT: "5358fc77b68ca120a07db686", PORT_NAME: "Puerto Cortes"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db686", PREV_PORT_NAME: "Puerto Cortes",
     PORT: "5358fc77b68ca120a07db680", PORT_NAME: "Puerto Barrios"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db680", PREV_PORT_NAME: "Puerto Barrios",
     PORT: "5358fc77b68ca120a07db686", PORT_NAME: "Puerto Cortes"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db686", PREV_PORT_NAME: "Puerto Cortes",
     PORT: "5358fc77b68ca120a07db680", PORT_NAME: "Puerto Barrios"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db680", PREV_PORT_NAME: "Puerto Barrios",
     PORT: "5358fc77b68ca120a07db686", PORT_NAME: "Puerto Cortes"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db686", PREV_PORT_NAME: "Puerto Cortes",
     PORT: "5358fc77b68ca120a07db680", PORT_NAME: "Puerto Barrios"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db680", PREV_PORT_NAME: "Puerto Barrios",
     PORT: "5358fc77b68ca120a07db686", PORT_NAME: "Puerto Cortes"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db686", PREV_PORT_NAME: "Puerto Cortes",
     PORT: "5358fc77b68ca120a07db680", PORT_NAME: "Puerto Barrios"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db680", PREV_PORT_NAME: "Puerto Barrios",
     PORT: "5358fc77b68ca120a07db686", PORT_NAME: "Puerto Cortes"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db686", PREV_PORT_NAME: "Puerto Cortes",
     PORT: "5358fc77b68ca120a07db680", PORT_NAME: "Puerto Barrios"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db680", PREV_PORT_NAME: "Puerto Barrios",
     PORT: "5358fc77b68ca120a07db686", PORT_NAME: "Puerto Cortes"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db686", PREV_PORT_NAME: "Puerto Cortes",
     PORT: "5358fc77b68ca120a07db680", PORT_NAME: "Puerto Barrios"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db680", PREV_PORT_NAME: "Puerto Barrios",
     PORT: "5358fc77b68ca120a07db686", PORT_NAME: "Puerto Cortes"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db686", PREV_PORT_NAME: "Puerto Cortes",
     PORT: "5358fc77b68ca120a07db680", PORT_NAME: "Puerto Barrios"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db680", PREV_PORT_NAME: "Puerto Barrios",
     PORT: "5358fc77b68ca120a07db686", PORT_NAME: "Puerto Cortes"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db686", PREV_PORT_NAME: "Puerto Cortes",
     PORT: "5358fc77b68ca120a07db680", PORT_NAME: "Puerto Barrios"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db680", PREV_PORT_NAME: "Puerto Barrios",
     PORT: "5358fc77b68ca120a07db686", PORT_NAME: "Puerto Cortes"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db686", PREV_PORT_NAME: "Puerto Cortes",
     PORT: "5358fc77b68ca120a07db680", PORT_NAME: "Puerto Barrios"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db680", PREV_PORT_NAME: "Puerto Barrios",
     PORT: "5358fc77b68ca120a07db686", PORT_NAME: "Puerto Cortes"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db686", PREV_PORT_NAME: "Puerto Cortes",
     PORT: "5358fc77b68ca120a07db680", PORT_NAME: "Puerto Barrios"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db680", PREV_PORT_NAME: "Puerto Barrios",
     PORT: "5358fc77b68ca120a07db686", PORT_NAME: "Puerto Cortes"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db686", PREV_PORT_NAME: "Puerto Cortes",
     PORT: "5358fc77b68ca120a07db680", PORT_NAME: "Puerto Barrios"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db680", PREV_PORT_NAME: "Puerto Barrios",
     PORT: "5358fc77b68ca120a07db686", PORT_NAME: "Puerto Cortes"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db686", PREV_PORT_NAME: "Puerto Cortes",
     PORT: "5358fc77b68ca120a07db680", PORT_NAME: "Puerto Barrios"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db680", PREV_PORT_NAME: "Puerto Barrios",
     PORT: "5358fc77b68ca120a07db686", PORT_NAME: "Puerto Cortes"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db686", PREV_PORT_NAME: "Puerto Cortes",
     PORT: "5358fc77b68ca120a07db680", PORT_NAME: "Puerto Barrios"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db680", PREV_PORT_NAME: "Puerto Barrios",
     PORT: "5358fc77b68ca120a07db686", PORT_NAME: "Puerto Cortes"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db686", PREV_PORT_NAME: "Puerto Cortes",
     PORT: "5358fc77b68ca120a07db680", PORT_NAME: "Puerto Barrios"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db680", PREV_PORT_NAME: "Puerto Barrios",
     PORT: "5358fc77b68ca120a07db686", PORT_NAME: "Puerto Cortes"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db686", PREV_PORT_NAME: "Puerto Cortes",
     PORT: "5358fc77b68ca120a07db680", PORT_NAME: "Puerto Barrios"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db680", PREV_PORT_NAME: "Puerto Barrios",
     PORT: "5358fc77b68ca120a07db686", PORT_NAME: "Puerto Cortes"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db686", PREV_PORT_NAME: "Puerto Cortes",
     PORT: "5358fc77b68ca120a07db680", PORT_NAME: "Puerto Barrios"},
]

naive_test_set = [
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc9f", PREV_PORT_NAME: "Kolkata",
     PORT: "5358fc78b68ca120a07dbc79", PORT_NAME: "Colombo"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbc79", PREV_PORT_NAME: "Colombo",
     PORT: "5358fc78b68ca120a07dbd3d", PORT_NAME: "Krishnapatnam"},
    {VESSEL_ID: "5905c345f222b84c4814fcaf", PREV_PORT: "5358fc78b68ca120a07dbd3d", PREV_PORT_NAME: "Krishnapatnam",
     PORT: "5358fc78b68ca120a07dbc9f", PORT_NAME: "Kolkata"},

    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db680", PREV_PORT_NAME: "Puerto Barrios",
     PORT: "5358fc77b68ca120a07db686", PORT_NAME: "Puerto Cortes"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db686", PREV_PORT_NAME: "Puerto Cortes",
     PORT: "5358fc77b68ca120a07db680", PORT_NAME: "Puerto Barrios"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db680", PREV_PORT_NAME: "Puerto Barrios",
     PORT: "5358fc77b68ca120a07db686", PORT_NAME: "Puerto Cortes"},
    {VESSEL_ID: "5905c34efc32e74c66922b8f", PREV_PORT: "5358fc77b68ca120a07db686", PREV_PORT_NAME: "Puerto Cortes",
     PORT: "5358fc77b68ca120a07db680", PORT_NAME: "Puerto Barrios"},
]


def create_encoder(values_to_encode: list) -> OrdinalEncoder:
    encoder = OrdinalEncoder(categories=[values_to_encode])
    encoder.fit([[value] for value in values_to_encode])
    return encoder


def encode(encoder: OrdinalEncoder, values: List[str], column_name: str) -> List[Dict[str, str]]:
    encoded_ports = []
    for value in values:
        encoded_port = encoder.transform([[value]])
        encoded_ports.append({column_name: value, f"{column_name}_ordinal": encoded_port[0]})
    return encoded_ports


def add_ordinal_label(unique_values, data_set_df: pd.DataFrame, column_name: str, outside_encoder: OrdinalEncoder = None) -> (pd.DataFrame, OrdinalEncoder):
    if outside_encoder is not None:
        encoder = outside_encoder
    else:
        encoder = create_encoder(unique_values)
    encoded_values = encode(encoder, unique_values, column_name)
    encoded_values_df = pd.DataFrame(encoded_values)
    return pd.merge(data_set_df, encoded_values_df, on=column_name, sort=False, how="left"), encoder
